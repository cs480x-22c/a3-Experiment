<script src="https://d3js.org/d3.v4.min.js"></script>

<!-- //working on setting up the starting page welcoming them to experiment -->
<!-- Work In Progress; haven't had time to fully check it with a server -->
<head>
  
  <style>
    * {box-sizing: border-box; }
    body {background-color: #F0F0F0; }

    #form {
      background-color: #fff;
      font-family: 'Times New Roman', Times, serif;
      padding: 60px;
      margin: 120px auto;
      min-width: 300px;
      width: 50%;     }

    h1 {text-align: center; }

    input{
      width: 100%;
      border: 1px solid #ababab;
      font-size: 15px;
      font-family: Arial, Helvetica, sans-serif;
      padding: 10px;
    }

    button:hover { opacity: 0.6; }

    button{
      border: none;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 15px;
      padding: 10px 20px;
      color: #fff;
      background-color: #020ebd;
      cursor: pointer;
    }

    .page{ display: none; }
  </style>
</head>

<!-- <style>

</style> -->

<body>
<!-- from what I've seen, I think it'll be best to make several class="page"
and then one page is the intro where they agree to start, second is stating the two values
and asking for their input on the percentage etc., and probably a third one saying thank you 
and stating that it's the end? WIP -->

  <h1> Experiment </h1>
  <svg id="pie" width="500" height="500"></svg>
  <svg id="my_dataviz" width="500" height="500"></svg>
</body>

<script>
  
  //functon to random number for number of splits
  function getRandomIntInclusive(min, max) {
  min = Math.ceil(min);
  max = Math.floor(max);
  return Math.floor(Math.random() * (max - min + 1) + min); //The maximum is inclusive and the     minimum is inclusive
  }

  //pie chart
  //function pie_chart() {
  var split = 5; //random number of splits for the chart
  //random values between 0 and 100
  var data = []; //initialize data
  for (i=0; i<split; i++){
    var new_data = getRandomIntInclusive(0, 100);
    data.push(new_data);
  }
  var svg1 = d3.select("svg"),
    width = svg1.attr("width"),
    height = svg1.attr("height"),
    radius1 = Math.min(width, height) / 2,
    g = svg1.append("g").attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");
  var color = d3.scaleOrdinal(['#4daf4a','#377eb8','#ff7f00','#984ea3','#e41a1c']);
  var pie = d3.pie();
  
  // Generate the arcs
  var arc = d3.arc()
    .innerRadius(0)
    .outerRadius(radius1);
              
  //Generate groups
  var arcs = g.selectAll("arc")
    .data(pie(data))
    .enter()
    .append("g")
    .attr("class", "arc")

  //Draw arc paths
  arcs.append("path")
    .attr('fill', 'white')
    .attr("stroke", "black")
    .style("stroke-width", "2px")
    .style("opacity", 0.7)
    .attr("d", arc);
//}

  //donut chart
  //function donut(){
  var width = 450
    height = 450
    margin = 40

    // The radius of the pieplot is half the width or half the height (smallest one). I subtract a bit of margin.
  var radius2 = Math.min(width, height) / 2 - margin

  // append the svg object to the div called 'my_dataviz'
  var svg2 = d3.select("#my_dataviz")
    .append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

  //Create dummy data
  //random values between 0 and 100
  var data_donut = []; //initialize data
  for (i=0; i<split; i++){
    var new_data = getRandomIntInclusive(0, 100);
    data_donut.push(new_data);
  }

  //set the color scale
  
  // Compute the position of each group on the pie:
  var pie = d3.pie()
    .value(function(d) {return d.value; })
  var data_ready = pie(d3.entries(data_donut))
  console.log(data_ready);

  //Build the pie chart: Basically, each part of the pie is a path that we build using the arc function.
  svg2.selectAll('whatever')
    .data(data_ready)
    .enter()
    .append('path')
    .attr('d', d3.arc()
      .innerRadius(100)         // This is the size of the donut hole
      .outerRadius(radius2))
    .attr('fill', 'white')
    .attr("stroke", "black")
    .style("stroke-width", "2px")
    .style("opacity", 0.7)
  
  //add dots to two of them randomly
  var donut_dot1 = getRandomIntInclusive(0,4);
  var donut_count = 0; //used to make sure not same slice
  while(donut_count<1){
    var rand = getRandomIntInclusive(0,4);
    if (rand == donut_dot1){} //do nothing
    else{
      var donut_dot2 = rand;
      donut_count++;
    }
  }

  var cx = width/2;
  var cy = height/2;
  var r = radius2-40;
  var a1 = data_ready[donut_dot1].startAngle;
  var b1 = data_ready[donut_dot1].endAngle;
  var c1 = (b1 + a1)/2; //need to fix, not halfway yet
  var x1 = cx + r * Math.cos(c1)
  var y1 = cy + r * Math.sin(c1)
  var a2 = data_ready[donut_dot2].startAngle;
  var b2 = data_ready[donut_dot2].endAngle;
  var c2 = (b2 + a2)/2;
  var x2 = cx + r * Math.cos(c2)
  var y2 = cy + r * Math.sin(c2)
  d3.select('#my_dataviz')
    .append('circle')
    .attr('cx', x1)
    .attr('cy', y1)
    .attr('r', 5);
  d3.select('#my_dataviz')
    .append('circle')
    .attr('cx', x2)
    .attr('cy', y2)
    .attr('r', 5);

 // }

</script>



